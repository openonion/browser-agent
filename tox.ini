[tox]
envlist = py39,py310,py311,automated,quick
skipsdist = True

[testenv]
# Base environment - runs all tests
deps =
    pytest>=7.0
    python-dotenv
    playwright
    rich
    pydantic
    -e ../connectonion
commands_pre =
    playwright install chromium
commands =
    pytest tests/ -v

[testenv:automated]
# Run only automated tests (skip manual interaction tests)
deps = {[testenv]deps}
commands_pre = {[testenv]commands_pre}
commands =
    pytest tests/ -m "not manual" -v

[testenv:quick]
# Run only quick tests (skip slow and manual tests)
deps = {[testenv]deps}
commands_pre = {[testenv]commands_pre}
commands =
    pytest tests/ -m "not slow and not manual" -v

[testenv:integration]
# Run only integration tests
deps = {[testenv]deps}
commands_pre = {[testenv]commands_pre}
commands =
    pytest tests/ -m integration -v

[testenv:manual]
# Run only manual tests
deps = {[testenv]deps}
commands_pre = {[testenv]commands_pre}
commands =
    pytest tests/ -m manual -v -s

[testenv:image]
# Test only image plugin functionality
deps = {[testenv]deps}
commands_pre = {[testenv]commands_pre}
commands =
    pytest tests/test_image_plugin.py -v

[testenv:coverage]
# Run tests with coverage report
deps =
    {[testenv]deps}
    pytest-cov
commands_pre = {[testenv]commands_pre}
commands =
    pytest tests/ -m "not manual" --cov=web_automation --cov=scroll_strategies --cov-report=term-missing --cov-report=html

[testenv:lint]
# Lint check (optional - only if you want linting)
skip_install = True
deps =
    ruff
commands =
    ruff check .
